---
template:
  id: story-template-v2
  name: Story Document
  version: 2.0
  output:
    format: markdown
    filename: docs/stories/2.1.Remote-Helm-Repository-Integration.md
    title: "Story 2.1: Remote Helm Repository Integration"
workflow:
  mode: interactive
  elicitation: advanced-elicitation
agent_config:
  editable_sections:
    - Status
    - Story
    - Acceptance Criteria
    - Tasks / Subtasks
    - Dev Notes
    - Testing
    - Change Log
---
# Story 2.1: Remote Helm Repository Integration

## Status
Draft

## Story
**As a** DevOps Engineer,
**I want** HelmGraph to fetch Helm charts from remote repositories (URLs or OCI registries),
**so that** I can analyze charts without needing to download them locally first.

## Acceptance Criteria
1. The tool accepts a remote Helm repository URL or OCI registry path as input.
2. The tool successfully fetches the specified Helm chart from the remote repository.
3. The tool integrates the fetched chart into the existing manifest generation process (Story 1.1).
4. The tool provides clear error messages if the remote repository is inaccessible or the chart cannot be fetched.

## Tasks / Subtasks
- [ ] **Task 1: Update Cobra CLI for remote repository input.** (AC: 1)
    - [ ] Add flags to the root command to accept a remote repository URL or OCI path.
    - [ ] Ensure the CLI can differentiate between local and remote chart paths.
- [ ] **Task 2: Implement Chart Fetching Logic.** (AC: 2)
    - [ ] In `internal/manifest/generator.go`, add a function to fetch Helm charts from a remote repository.
    - [ ] Use the `helm pull` command or a suitable Go Helm SDK to download the chart.
- [ ] **Task 3: Integrate with Manifest Generation.** (AC: 3)
    - [ ] Modify the manifest generation logic to use the fetched chart as input for the `helm template` command.
- [ ] **Task 4: Add Error Handling.** (AC: 4)
    - [ ] Implement error handling for inaccessible repositories or failed chart fetching.
- [ ] **Task 5: Write Unit and Integration Tests.**
    - [ ] Write unit tests for the chart fetching logic.
    - [ ] Write integration tests to verify the end-to-end remote chart processing.

## Dev Notes
- **Helm Interaction**: The tool will continue to interact with the Helm CLI using the `os/exec` package. The `helm pull` command will be used for fetching remote charts. [Source: docs/architecture/tech-stack.md]
- **CLI Framework**: The Cobra library will be used to add the new flags for remote repository input. [Source: docs/architecture/tech-stack.md]
- **File Locations**: The chart fetching logic will be added to `internal/manifest/generator.go`. [Source: docs/architecture/source-tree.md]

### Testing
- **Unit Tests**: Unit tests should be created in `_test.go` files in the same package as the code they are testing.
- **Integration Tests**: Integration tests for this feature should be placed in `test/integration/`.
[Source: docs/architecture/coding-standards.md]

## Change Log
| Date | Version | Description | Author |
|---|---|---|---|
| 2025-09-01 | 1.0 | Initial draft | Bob (Scrum Master) |

## Dev Agent Record
### Agent Model Used
{{agent_model_name_version}}
### Debug Log References
-
### Completion Notes List
-
### File List
-

## QA Results
-
