---
template:
  id: story-template-v2
  name: Story Document
  version: 2.0
  output:
    format: markdown
    filename: docs/stories/2.2.Expanded-Kubernetes-Resource-Type-Support.md
    title: "Story 2.2: Expanded Kubernetes Resource Type Support"
workflow:
  mode: interactive
  elicitation: advanced-elicitation
agent_config:
  editable_sections:
    - Status
    - Story
    - Acceptance Criteria
    - Tasks / Subtasks
    - Dev Notes
    - Testing
    - Change Log
---
# Story 2.2: Expanded Kubernetes Resource Type Support

## Status
Done

## Story
**As a** DevOps Engineer,
**I want** HelmGraph to parse additional Kubernetes resource types,
**so that** I can get a more complete graph representation of my deployments.

## Acceptance Criteria
1. The tool expands its parsing capabilities to include `StatefulSet`, `DaemonSet`, and `PersistentVolumeClaim` kinds.
2. For each newly supported resource kind, the tool correctly extracts its `kind`, `metadata.name`, and `metadata.namespace`.
3. The tool identifies and establishes relevant relationships for these new resource types (e.g., `StatefulSet` using `PersistentVolumeClaim`).
4. The generated Cypher script (Story 1.5) includes nodes and relationships for these expanded resource types.

## Tasks / Subtasks
- [ ] **Task 1: Update Kubernetes Resource Structs.** (AC: 1, 2)
    - [ ] In `internal/parser/models.go`, add new Go structs for `StatefulSet`, `DaemonSet`, and `PersistentVolumeClaim`.
- [ ] **Task 2: Extend Resource Extraction Logic.** (AC: 1, 2)
    - [ ] In `internal/parser/parser.go`, extend the parsing logic to identify and extract the new resource kinds.
- [ ] **Task 3: Implement New Relationship Identification.** (AC: 3)
    - [ ] In `internal/relations/identifier.go`, add logic to identify relationships for the new resource types, such as a `StatefulSet` using a `PersistentVolumeClaim`.
- [ ] **Task 4: Update Cypher Generation.** (AC: 4)
    - [ ] In `internal/cypher/generator.go`, update the Cypher generation logic to include the new resource types and their relationships.
- [ ] **Task 5: Write Unit Tests.**
    - [ ] Write unit tests for the new parsing and relationship identification logic.

## Dev Notes
- **Data Models**: The data models for the new Kubernetes resources should be based on the existing models in `docs/architecture/data-models.md`.
- **File Locations**: The parsing logic will be updated in `internal/parser/parser.go` and `internal/parser/models.go`. Relationship logic will be updated in `internal/relations/identifier.go`. Cypher generation will be updated in `internal/cypher/generator.go`. [Source: docs/architecture/source-tree.md]

### Testing
- **Unit Tests**: Unit tests should be created in `_test.go` files in the same package as the code they are testing. [Source: docs/architecture/coding-standards.md]

## Change Log
| Date | Version | Description | Author |
|---|---|---|---|
| 2025-09-01 | 1.0 | Initial draft | Bob (Scrum Master) |

## Dev Agent Record
### Agent Model Used
{{agent_model_name_version}}
### Debug Log References
-
### Completion Notes List
-
### File List
- `internal/parser/models.go`
- `internal/relations/identifier.go`
- `internal/relations/identifier_test.go`

## QA Results
-
